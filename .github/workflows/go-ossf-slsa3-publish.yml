# 此工作流程使用了未经 GitHub 认证的操作。
# 它们由第三方提供，并受其单独的服务条款、
# 隐私政策和支持文档的约束。

# 此工作流程让您可以使用符合 SLSA3 标准的构建器来编译您的 Go 项目。
# 此工作流程将生成一个所谓的“来源”（provenance）文件，描述生成最终二进制文件所执行的步骤。
# 该项目是 OpenSSF (openssf.org) 的一项倡议，并在 https://github.com/slsa-framework/slsa-github-generator 开发。
# 来源文件可以使用 https://github.com/slsa-framework/slsa-verifier 进行验证。
# 有关 SLSA 及其如何改善供应链的更多信息，请访问 slsa.dev。

name: SLSA Go 发布器工作流程
on:
  workflow_dispatch: # 允许手动触发工作流程
  release:
    types: [created] # 当有新版本发布时触发

permissions: read-all # 设置默认权限为读取所有内容

jobs:
  # ========================================================================================================================================
  #     前提条件：在项目的根目录下创建一个 .slsa-goreleaser.yml 文件。
  #       配置文件格式请参阅：https://github.com/slsa-framework/slsa-github-generator/blob/main/internal/builders/go/README.md#configuration-file
  # =========================================================================================================================================
  build:
    permissions:
      id-token: write # 用于签名（证明来源）
      contents: write # 用于上传发布资源（如编译好的二进制文件）
      actions: read # 用于读取工作流程路径
    uses: slsa-framework/slsa-github-generator/.github/workflows/builder_go_slsa3.yml@v1.4.0 # 重用社区提供的预定义工作流程
    with:
      go-version: 1.23 # 指定使用的 Go 版本
      # =============================================================================================================
      #     可选参数：更多选项请参阅 https://github.com/slsa-framework/slsa-github-generator#golang-projects
      # =============================================================================================================
